<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Ahmad Y Abuhelwa, David J.R Foster, Richard N Upton" />

<meta name="date" content="2016-10-04" />

<title></title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>


<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>



<div class="fluid-row" id="header">


<h1 class="title"><h2 id="pkadvan-an-r-package-for-simulating-from-various-pk-models">PKADVAN: an R package for simulating from various PK models</h2></h1>
<h4 class="author"><em>Ahmad Y Abuhelwa, David J.R Foster, Richard N Upton</em></h4>
<h4 class="date"><em>2016-10-04</em></h4>

</div>


<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>ADVAN-style analytical solutions for 1, 2, 3 compartment linear pharmacokinetic models of intravenous bolus, infusion, and first-order absorption have been derived and published by <a href="http://www.ncbi.nlm.nih.gov/pubmed/25841670">Abuhelwa et al., 2015</a> <a href="#fn1" class="footnoteRef" id="fnref1"><sup>1</sup></a>. The analytical solutions are used to simulate the time-course of drug amounts in the compartments of a pharmacokinetic models and they “advance” the solution of the model from one time point to the next, allowing for any dose or time-varying covariate factors to be accounted for. The ADVAN-style analytical solutions were coded in the R programming language <a href="#fn2" class="footnoteRef" id="fnref2"><sup>2</sup></a> and have been shown to have speed advantages over solutions using differential equation solvers [1].</p>
</div>
<div id="aims" class="section level2">
<h2>Aims</h2>
<p>The aims of this work were to:</p>
<ul>
<li><p>Enhance the computational speed of the ADVAN-style analytical functions through coding them in hybrid R/C++ programming languages for faster simulation processing.</p></li>
<li><p>Present the ADVAN-style analytical functions in an R package, <strong>PKADVAN package</strong> and make them available for the wider audience.</p></li>
<li><p>Expand the “PKADVAN” package library to include other pharmacokinetic models such as transit first-order absorption and metabolite models.</p></li>
</ul>
</div>
<div id="methods" class="section level2">
<h2>Methods</h2>
<ul>
<li><p>The ADVAN-style analytical solutions were derived using Laplace transforms and then were coded in the C++ programming language and integrated into R using the Rcpp package attributes <a href="#fn3" class="footnoteRef" id="fnref3"><sup>3</sup></a>.</p></li>
<li><p>The integrated R/C++ ADVAN-style analytical functions were built into an open-source R package (“PKADVAN” package).</p></li>
<li><p>To assess computational speed, simulations for 1000 subjects using three compartment IV bolus, infusion, and first-order absorption models were performed and compared to relative computational speed of the equivalent R-coded functions. For each subject, two doses were simulated with the evaluations performed at 1 hour time intervals for 2 days.</p></li>
<li><p>All pharmacokinetic models incorporated into the PKADVAN package have been validated against the commercially available population pharmacokinetic modelling software NONMEM.</p></li>
</ul>
</div>
<div id="pkadvan-package" class="section level2">
<h2>PKADVAN package</h2>
<ul>
<li><p>A total of 26 pharmacokinetic models were incorporated into the <a href="https://github.com/abuhelwa/PKADVAN_Rpackage">PKADVAN package</a> library including the basic models published by Abuhelwa et al [1]. A list of all the models is presented in Table 1.</p></li>
<li><p>To perform pharmacokinetic simulations using the “PKADVAN” package, two simple steps are required: (1) Supply a NONMEM-style simulation data frame with the individual pharmacokinetic parameters including any covariate effects on the PK parameters (2) Call the “PKADVAN” function of the respective model to process simulations.</p></li>
<li><p>The NONMEM-style data frame should have the following columns: ID, TIME, AMT, in addition to the individual pharmacokinetic parameters of the respective pharmacokinetic model (e.g., CL, V, Q). The PKADVAN functions returns the drug amounts in the respective compartments and the individual predicted concentrations (IPRED) in the central compartment of the pharmacokinetic system.</p></li>
<li><p>The PKADVAN functions are capable of simulating arbitrary dosing regimens and can account for time-changing covariate structures; however, covariate effects on respective parameters must be calculated prior processing simulations.</p></li>
<li><p>All the PKADVAN functions were validated against NONMEM and both outputs were identical. Stochastic population pharmacokinetic model simulations using the PKADVAN functions are comparable to NONMEM. An example output using PKADVAN package versus NONMEM is presented in Figure 1. The R-script for processing the simulations presented in Figure 1 is provided <a href="https://github.com/abuhelwa/PKADVAN_Rpackage/tree/master/WCOP2016PKexample">here</a>.</p></li>
<li><p>The “PKADVAN” package is available on GitHub and can be downloaded by clicking <a href="https://github.com/abuhelwa/PKADVAN_Rpackage">here</a>.</p></li>
<li><p>Users are encouraged to read the package documentation and run the simulation examples provided with the package.</p></li>
<li><p>Simulations using the integrated R/C++ ADVAN-style analytical solutions were substantially faster (8‑34 times) than the equivalent R-coded functions (Table 2). The relative speed of the integrated R/C++ functions was greater with the more complex models and with more extensive sample time evaluations (Table 2).</p></li>
</ul>
<div id="table-1-pharmacokinetic-models-of-the-pkadvan-library" class="section level6">
<h6>Table 1: Pharmacokinetic models of the ‘PKADVAN’ library</h6>
<table style="width:114%;">
<colgroup>
<col width="37%"></col>
<col width="40%"></col>
<col width="36%"></col>
</colgroup>
<thead>
<tr class="header">
<th align="left">Category</th>
<th align="left">Pharmacokinetic model</th>
<th align="left">PKADVAN function name</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Basic PK models</td>
<td align="left">1 comp IV bolus</td>
<td align="left"><code>OneCompIVbolus</code></td>
</tr>
<tr class="even">
<td align="left">Basic PK models</td>
<td align="left">2 comp IV bolus</td>
<td align="left"><code>TwoCompIVbolus</code></td>
</tr>
<tr class="odd">
<td align="left">Basic PK models</td>
<td align="left">3 comp IV bolus</td>
<td align="left"><code>ThreeCompIVbolus</code></td>
</tr>
<tr class="even">
<td align="left">Basic PK models</td>
<td align="left">1 comp IV infusion</td>
<td align="left"><code>OneCompIVinfusion</code></td>
</tr>
<tr class="odd">
<td align="left">Basic PK models</td>
<td align="left">2 comp IV infusion</td>
<td align="left"><code>TwoCompIVinfusion</code></td>
</tr>
<tr class="even">
<td align="left">Basic PK models</td>
<td align="left">3 comp IV infusion</td>
<td align="left"><code>ThreeCompIVinfusion</code></td>
</tr>
<tr class="odd">
<td align="left">Basic PK models</td>
<td align="left">1 comp first-order absorption</td>
<td align="left"><code>OneCompFirstOrderAbs</code></td>
</tr>
<tr class="even">
<td align="left">Basic PK models</td>
<td align="left">2 comp first-order absorption</td>
<td align="left"><code>TwoCompFirstOrderAbs</code></td>
</tr>
<tr class="odd">
<td align="left">Basic PK models</td>
<td align="left">3 comp first-order absorption</td>
<td align="left"><code>ThreeCompFirstOrderAbs</code></td>
</tr>
<tr class="even">
<td align="left">Transit first-order absorption models</td>
<td align="left">1 comp-1 transit</td>
<td align="left"><code>OneCompOneTransit</code></td>
</tr>
<tr class="odd">
<td align="left">Transit first-order absorption models</td>
<td align="left">1 comp-2 transit</td>
<td align="left"><code>OneCompTwoTransit</code></td>
</tr>
<tr class="even">
<td align="left">Transit first-order absorption models</td>
<td align="left">1 comp-3 transit</td>
<td align="left"><code>OneCompThreeTransit</code></td>
</tr>
<tr class="odd">
<td align="left">Transit first-order absorption models</td>
<td align="left">1 comp-4 transit</td>
<td align="left"><code>OneCompFourTransit</code></td>
</tr>
<tr class="even">
<td align="left">Transit first-order absorption models</td>
<td align="left">2 comp-1 transit</td>
<td align="left"><code>TwoCompOneTransit</code></td>
</tr>
<tr class="odd">
<td align="left">Transit first-order absorption models</td>
<td align="left">2 comp-2 transit</td>
<td align="left"><code>TwoCompTwoTransit</code></td>
</tr>
<tr class="even">
<td align="left">Transit first-order absorption models</td>
<td align="left">2 comp-3 transit</td>
<td align="left"><code>TwoCompThreeTransit</code></td>
</tr>
<tr class="odd">
<td align="left">Transit first-order absorption models</td>
<td align="left">2 comp-4 transit</td>
<td align="left"><code>TwoCompFourTransit</code></td>
</tr>
<tr class="even">
<td align="left">First-order formation metabolite models</td>
<td align="left">1 comp IV bolus-1 comp metabolite</td>
<td align="left"><code>OneCompIVbolusOneCompMetab</code></td>
</tr>
<tr class="odd">
<td align="left">First-order formation metabolite models</td>
<td align="left">2 comp IV bolus-1 comp metabolite</td>
<td align="left"><code>TwoCompIVbolusOneCompMetab</code></td>
</tr>
<tr class="even">
<td align="left">First-order formation metabolite models</td>
<td align="left">3 comp IV bolus-1 comp metabolite</td>
<td align="left"><code>ThreeCompIVbolusOneCompMetab</code></td>
</tr>
<tr class="odd">
<td align="left">First-order formation metabolite models</td>
<td align="left">1 comp IV infusion-1 comp metabolite</td>
<td align="left"><code>OneCompIVinfusionOneCompMetab</code></td>
</tr>
<tr class="even">
<td align="left">First-order formation metabolite models</td>
<td align="left">2 comp IV infusion-1 comp metabolite</td>
<td align="left"><code>TwoCompIVinfusionOneCompMetab</code></td>
</tr>
<tr class="odd">
<td align="left">First-order formation metabolite models</td>
<td align="left">3 comp IV infusion-1 comp metabolite</td>
<td align="left"><code>ThreeCompIVinfusionOneCompMetab</code></td>
</tr>
<tr class="even">
<td align="left">First-order formation metabolite models</td>
<td align="left">1 comp first-order absorption-1 comp metabolite</td>
<td align="left"><code>OneCompFirstOrderAbsOneCompMetab</code></td>
</tr>
<tr class="odd">
<td align="left">First-order formation metabolite models</td>
<td align="left">2 comp first-order absorption-1 comp metabolite</td>
<td align="left"><code>TwoCompFirstOrderAbsOneCompMetab</code></td>
</tr>
<tr class="even">
<td align="left">First-order formation metabolite models</td>
<td align="left">3 comp first-order absorption-1 comp metabolite</td>
<td align="left"><code>ThreeCompFirstOrderAbsOneCompMetab</code></td>
</tr>
</tbody>
</table>
</div>
<div id="table2-comparison-of-computation-time-r-functions-versus-the-integrated-rc-pkadvan-functions" class="section level6">
<h6>Table2: Comparison of computation time: R-functions versus the integrated R/C++ PKADVAN functions</h6>
<table style="width:97%;">
<colgroup>
<col width="44%"></col>
<col width="15%"></col>
<col width="23%"></col>
<col width="13%"></col>
</colgroup>
<thead>
<tr class="header">
<th align="left">Pharmacokinetic model</th>
<th align="left">R-functions (seconds)<sup>a</sup></th>
<th align="left">PKADVAN functions (seconds)<sup>a</sup></th>
<th align="left">Relative speed</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">3 comp IV bolus</td>
<td align="left">20.37 ± 0.08</td>
<td align="left">1.33 ± 0.02</td>
<td align="left">15.32</td>
</tr>
<tr class="even">
<td align="left">3 comp first-order absorption</td>
<td align="left">26.70 ± 0.42</td>
<td align="left">1.52 ± 0.01</td>
<td align="left">17.57</td>
</tr>
<tr class="odd">
<td align="left">3 comp IV-infusion</td>
<td align="left">61.42 ± 0.17</td>
<td align="left">5.04 ± 0.05</td>
<td align="left">12.19</td>
</tr>
<tr class="even">
<td align="left">3 comp first-order absorption-extended<sup>b</sup></td>
<td align="left">64.67 ± 0.17</td>
<td align="left">1.90 ± 0.02</td>
<td align="left">33.98</td>
</tr>
</tbody>
</table>
<p><sup>a</sup> Mean ± SD computation time required to process simulations for 1000 subjects based on three compartment intravenous bolus, infusion, and first-order absorption models. For each subject, two doses were simulated with the evaluations performed at 1 hour time intervals for 2 days.</p>
<p><sup>b</sup> The same dosing regimen simulations extended for 5 days.</p>
<p><br><br></p>
<p><img src="data:image/png;base64,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" alt="Figurexxx 2" /></p>
</div>
</div>
<div id="simulation-example" class="section level2">
<h2>Simulation Example</h2>
<p>The following example illustrates the use of <strong>PKADVAN</strong> package to simulate the concentartion-time profiles of 1,000 subjects based on two compartment-two transit first-order oral absorption model. Creatinine clearance was added as a time-changing covariate on central clearance to show the cabability of the package in handling time-changing covariates. Between subject variability was added on <code>CL</code>, <code>V2</code>, <code>Q</code>, <code>V3</code>, <code>KA</code>. Proportional and additive residual error model was added on the individual predictions.</p>
<p><br></p>
<p><img src="data:image/png;base64,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" alt="Figure 3" /></p>
<div id="step-1-generate-a-nonmem-style-data-frame" class="section level3">
<h3>Step 1: Generate a NONMEM-style data frame</h3>
<p>If you have a NONMEM-style data frame then load it into R and skip this step, otherwise, use R to generate a simulation data frame.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">rm</span>(<span class="dt">list=</span><span class="kw">ls</span>(<span class="dt">all=</span><span class="ot">TRUE</span>))
    <span class="kw">graphics.off</span>()

<span class="co">#load packages</span>
    <span class="kw">library</span>(PKADVAN)
    <span class="kw">library</span>(plyr)
    <span class="kw">library</span>(ggplot2)
    
<span class="co">#Function for 90% confidence intervals calculation</span>
    CI90lo &lt;-<span class="st"> </span>function(x) <span class="kw">quantile</span>(x, <span class="dt">probs=</span><span class="fl">0.05</span>,<span class="dt">na.rm=</span>T)
    CI90hi &lt;-<span class="st"> </span>function(x) <span class="kw">quantile</span>(x, <span class="dt">probs=</span><span class="fl">0.95</span>,<span class="dt">na.rm=</span>T)

<span class="co">#-----------------------------------------------</span>
<span class="co"># Generate a NONMEM-style simulation data frame</span>
<span class="co">#-----------------------------------------------</span>
    <span class="co">#Set dose records: It can be arbitrary.</span>
    dosetimes &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">48</span>,<span class="dv">12</span>))
    tlast &lt;-<span class="st"> </span><span class="dv">96</span>
    
    <span class="co">#Now define finer sample times for after a dose to capture Cmax</span>
    doseseq &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>,<span class="dv">1</span>,<span class="fl">1.5</span>,<span class="dv">2</span>,<span class="fl">2.5</span>,<span class="dv">3</span>,<span class="fl">3.5</span>,<span class="dv">4</span>,<span class="fl">4.5</span>,<span class="dv">5</span>,<span class="fl">5.5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>,<span class="dv">10</span>)
    
    <span class="co">#Use the outer product but with addition to expand this doseseq for all dosetimes</span>
    PKtimes &lt;-<span class="st"> </span><span class="kw">outer</span>(dosetimes,doseseq,<span class="st">&quot;+&quot;</span>)
    
    <span class="co">#set number of subjects</span>
    nsub &lt;-<span class="st"> </span><span class="dv">1000</span>
    ID &lt;-<span class="st"> </span><span class="dv">1</span>:nsub
    
    <span class="co">#Make dataframe</span>
    df &lt;-<span class="st"> </span><span class="kw">expand.grid</span>(<span class="st">&quot;ID&quot;</span>=ID,<span class="st">&quot;TIME&quot;</span>=<span class="kw">sort</span>(<span class="kw">unique</span>(<span class="kw">c</span>(<span class="kw">seq</span>(<span class="dv">0</span>,tlast,<span class="dv">1</span>),PKtimes))),<span class="st">&quot;AMT&quot;</span>=<span class="dv">0</span>,<span class="st">&quot;MDV&quot;</span>=<span class="dv">0</span>,<span class="st">&quot;DV&quot;</span>=<span class="ot">NA</span>,<span class="st">&quot;CLCR&quot;</span>=<span class="dv">120</span>)
    
    df$CLCR[df$TIME &gt;=<span class="st"> </span><span class="dv">36</span>] &lt;-<span class="st"> </span><span class="dv">80</span>  <span class="co">#Allow CLCR to change</span>
    
    doserows &lt;-<span class="st"> </span><span class="kw">subset</span>(df, TIME%in%dosetimes)
    
    <span class="co">#Dose: It can be any arbitrary dose</span>
    doserows$AMT &lt;-<span class="st"> </span><span class="dv">500</span>
    doserows$MDV &lt;-<span class="st"> </span><span class="dv">1</span>
    
    <span class="co">#Add back dose information</span>
    df &lt;-<span class="st"> </span><span class="kw">rbind</span>(df,doserows)
    df &lt;-<span class="st"> </span>df[<span class="kw">order</span>(df$ID,df$TIME,df$AMT),]       <span class="co"># arrange df by TIME (ascending) and by AMT (descending)</span>
    df &lt;-<span class="st"> </span><span class="kw">subset</span>(df, (TIME==<span class="dv">0</span> &amp;<span class="st"> </span>AMT==<span class="dv">0</span>)==F) <span class="co"># remove the row that has a TIME=0 and AMT=0</span>
    <span class="kw">head</span>(df)</code></pre></div>
<pre><code>##        ID TIME AMT MDV DV CLCR
## 127001  1  0.0 500   1 NA  120
## 1001    1  0.5   0   0 NA  120
## 2001    1  1.0   0   0 NA  120
## 3001    1  1.5   0   0 NA  120
## 4001    1  2.0   0   0 NA  120
## 5001    1  2.5   0   0 NA  120</code></pre>
</div>
<div id="step-2-define-parameters-of-the-pharmacokinetic-model" class="section level3">
<h3>Step 2: Define parameters of the pharmacokinetic model</h3>
<p>This includes setting population PK parameters, between subject variability, and residual error model parameters.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#----------------------------------------------------------------------------</span>
<span class="co"># Two compartment-2 transit first-order absorption model via PKADVAN package</span>
<span class="co">#----------------------------------------------------------------------------</span>
<span class="co">#Define between subject variability on PK parameters</span>
    <span class="co">#BSV (Omegas as SD)</span>
    ETA1CL  &lt;-<span class="st"> </span><span class="fl">0.15</span>     
    ETA2V2  &lt;-<span class="st"> </span><span class="fl">0.12</span>     
    ETA3Q   &lt;-<span class="st"> </span><span class="fl">0.14</span>     
    ETA4V3  &lt;-<span class="st"> </span><span class="fl">0.05</span>     
    ETA5KTR &lt;-<span class="st"> </span><span class="fl">0.30</span>    

<span class="co">#Define residual error model</span>
    <span class="co">#Residuals (Epsilons as SD)</span>
    EPS1    &lt;-<span class="st"> </span><span class="fl">0.10</span>     <span class="co">#Proportional residual error</span>
    EPS2    &lt;-<span class="st"> </span><span class="fl">0.15</span>     <span class="co">#Additive residual error</span>

    <span class="co">#Use random number generator to simulate residuals from a normal distribution    </span>
    BSVCL   &lt;-<span class="st"> </span><span class="kw">rnorm</span>(nsub, <span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> ETA1CL)   <span class="co">#BSV on CL  </span>
    BSVV2   &lt;-<span class="st"> </span><span class="kw">rnorm</span>(nsub, <span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> ETA2V2)   <span class="co">#BSV on V2  </span>
    BSVQ    &lt;-<span class="st"> </span><span class="kw">rnorm</span>(nsub, <span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> ETA3Q)    <span class="co">#BSV on Q</span>
    BSVV3   &lt;-<span class="st"> </span><span class="kw">rnorm</span>(nsub, <span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> ETA4V3)   <span class="co">#BSV on V3</span>
    BSVKTR  &lt;-<span class="st"> </span><span class="kw">rnorm</span>(nsub, <span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> ETA5KTR)  <span class="co">#BSV on KTR</span>

    EPS1 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(nsub, <span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> EPS1)    <span class="co">#Proportional residual error</span>
    EPS2 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(nsub, <span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> EPS2)    <span class="co">#Additive residual error</span>
    
<span class="co">#Set population PK parameters for 2-compartment First-order absorption model</span>
    CLpop   &lt;-<span class="st"> </span><span class="fl">0.5</span>      <span class="co">#central clearance</span>
    V2pop   &lt;-<span class="st"> </span><span class="dv">20</span>       <span class="co">#central volume of distribution</span>
    Qpop    &lt;-<span class="st"> </span><span class="dv">1</span>        <span class="co">#inter-compartmental clearance</span>
    V3pop   &lt;-<span class="st"> </span><span class="dv">25</span>       <span class="co">#peripheral volume of distribution</span>
    KTRpop  &lt;-<span class="st"> </span><span class="fl">2.05</span>     <span class="co">#first-order absorption rate constant</span>
    F1pop   &lt;-<span class="st"> </span><span class="fl">0.80</span>     <span class="co">#Bioavailability</span></code></pre></div>
</div>
<div id="step-3-modify-the-simulation-data-frame-for-pkadvan-calculation-and-include-any-covariates-on-the-pk-parameters" class="section level3">
<h3>Step 3: Modify the simulation data frame for PKADVAN calculation and include any covariates on the PK parameters</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">inputDataFrame &lt;-<span class="st"> </span>df
<span class="co">#Calculate group parameter values including any covariate effects</span>
    inputDataFrame$CL  &lt;-<span class="st"> </span>CLpop*<span class="kw">exp</span>(BSVCL)*(inputDataFrame$CLCR/<span class="dv">100</span>)   <span class="co">#creatinine clearance added as a time-changing covariate on CL</span>
    inputDataFrame$V2  &lt;-<span class="st"> </span>V2pop*<span class="kw">exp</span>(BSVV2)
    inputDataFrame$Q   &lt;-<span class="st"> </span>Qpop*<span class="kw">exp</span>(BSVQ)
    inputDataFrame$V3  &lt;-<span class="st"> </span>V3pop*<span class="kw">exp</span>(BSVV3)
    inputDataFrame$KTR &lt;-<span class="st"> </span>KTRpop*<span class="kw">exp</span>(BSVKTR)
    inputDataFrame$F1  &lt;-<span class="st"> </span>F1pop
    <span class="kw">head</span>(inputDataFrame)</code></pre></div>
<pre><code>##        ID TIME AMT MDV DV CLCR        CL       V2         Q       V3
## 127001  1  0.0 500   1 NA  120 0.5531669 22.15565 0.9163143 27.06188
## 1001    1  0.5   0   0 NA  120 0.6769442 19.21498 1.0086418 27.20716
## 2001    1  1.0   0   0 NA  120 0.6444299 19.89713 1.1427753 22.51905
## 3001    1  1.5   0   0 NA  120 0.9103612 22.67246 1.0554098 24.84130
## 4001    1  2.0   0   0 NA  120 0.6234081 17.28469 1.0225333 24.77075
## 5001    1  2.5   0   0 NA  120 0.5214483 17.59508 1.0240213 24.97505
##             KTR  F1
## 127001 1.611154 0.8
## 1001   4.032071 0.8
## 2001   2.178235 0.8
## 3001   2.055517 0.8
## 4001   1.445166 0.8
## 5001   2.319659 0.8</code></pre>
</div>
<div id="step-4-apply-pkadvan-function-of-the-selected-pk-model" class="section level3">
<h3>Step 4: Apply PKADVAN function of the selected PK model</h3>
<p>To simulate a population (i.e. the <code>inputDataFrame</code> has more than one subject <code>ID</code>), the function has to be applied for each subject <code>ID</code>. One way of doing that is through using the <code>ddply</code> functionality in the <strong>plyr</strong> package in R. The <code>ddply</code> functionality allows applying the PKADVAN function to each subject ID and combines the results into a data frame.</p>
<p>The function calculates the amounts in the absorption (<code>A1</code>), first, and second transit (<code>A4, A5</code>), respectively, central (<code>A2</code> &amp; individual predicted concentrations, <code>IPRED</code>) and peripheral compartment (<code>A3</code>) and returns the output added to the inputDataFrame</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">simdf &lt;-<span class="st"> </span><span class="kw">ddply</span>(inputDataFrame, .(ID), TwoCompTwoTransit)
<span class="kw">head</span>(simdf)</code></pre></div>
<pre><code>##   ID TIME AMT MDV DV CLCR        CL       V2         Q       V3      KTR
## 1  1  0.0 500   1 NA  120 0.5531669 22.15565 0.9163143 27.06188 1.611154
## 2  1  0.5   0   0 NA  120 0.6769442 19.21498 1.0086418 27.20716 4.032071
## 3  1  1.0   0   0 NA  120 0.6444299 19.89713 1.1427753 22.51905 2.178235
## 4  1  1.5   0   0 NA  120 0.9103612 22.67246 1.0554098 24.84130 2.055517
## 5  1  2.0   0   0 NA  120 0.6234081 17.28469 1.0225333 24.77075 1.445166
## 6  1  2.5   0   0 NA  120 0.5214483 17.59508 1.0240213 24.97505 2.319659
##    F1          A1         A4        A5       A2        A3     IPRED
## 1 0.8 400.0000000   0.000000   0.00000   0.0000  0.000000  0.000000
## 2 0.8  53.2729561 107.400183 108.26130 129.1484  1.145152  6.721233
## 3 0.8  17.9270594  55.666267  86.42615 229.9780  6.283230 11.558352
## 4 0.8   6.4144475  26.510345  54.78246 291.0630 12.221110 12.837731
## 5 0.8   3.1141928  15.120946  36.70984 309.8062 20.801530 17.923736
## 6 0.8   0.9764227   5.873499  17.66550 326.6926 29.601063 18.567265</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#plot IPRED</span>
    plotobj &lt;-<span class="st"> </span><span class="ot">NULL</span>
    titletext &lt;-<span class="st"> </span><span class="kw">expression</span>(<span class="kw">atop</span>(<span class="st">&quot;Simulated Drug Concentrations&quot;</span>,
                                 <span class="kw">atop</span>(<span class="kw">italic</span>(<span class="st">&quot;Two compartment- two tranist first-order absorption&quot;</span>),<span class="st">&quot;Median and 90% Prediction Interval, 1000 subjects&quot;</span>))) 
    plotobj &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data=</span>simdf)
    plotobj &lt;-<span class="st"> </span>plotobj +<span class="st"> </span><span class="kw">stat_summary</span>(<span class="kw">aes</span>(<span class="dt">x=</span>TIME, <span class="dt">y=</span> IPRED),<span class="dt">fun.y=</span>median, <span class="dt">geom=</span><span class="st">&quot;line&quot;</span>, <span class="dt">colour=</span><span class="st">&quot;red&quot;</span>, <span class="dt">size=</span><span class="dv">1</span>)
    plotobj &lt;-<span class="st"> </span>plotobj +<span class="st"> </span><span class="kw">stat_summary</span>(<span class="kw">aes</span>(<span class="dt">x=</span>TIME, <span class="dt">y=</span> IPRED),<span class="dt">geom=</span><span class="st">&quot;ribbon&quot;</span>, <span class="dt">fun.ymin=</span><span class="st">&quot;CI90lo&quot;</span>, <span class="dt">fun.ymax=</span><span class="st">&quot;CI90hi&quot;</span>, <span class="dt">alpha=</span><span class="fl">0.3</span>)
    plotobj &lt;-<span class="st"> </span>plotobj +<span class="st"> </span><span class="kw">ggtitle</span>(titletext)
    plotobj &lt;-<span class="st"> </span>plotobj +<span class="st"> </span><span class="kw">scale_y_continuous</span>(<span class="st">&quot;IPREDs</span><span class="ch">\n</span><span class="st">&quot;</span>)
    plotobj &lt;-<span class="st"> </span>plotobj +<span class="st"> </span><span class="kw">scale_x_continuous</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">Time after dose&quot;</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">  plotobj</code></pre></div>
<p><img src="data:image/png;base64,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" alt /></p>
</div>
<div id="step-5-add-residual-unexplained-variability-within-subject-variability-on-ipreds" class="section level3">
<h3>Step 5: Add residual unexplained variability (within subject variability) on IPREDs</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#combined additive and proportional error model</span>
    simdf$DV &lt;-<span class="st"> </span>simdf$IPRED*(<span class="dv">1</span> +<span class="st"> </span>EPS1) +<span class="st"> </span>EPS2

<span class="co">#Plotting   </span>
    <span class="co">#Subset missing data</span>
    simdf &lt;-<span class="st"> </span><span class="kw">subset</span>(simdf, MDV==<span class="dv">0</span>)
 <span class="co">#DV</span>
    plotobj &lt;-<span class="st"> </span><span class="ot">NULL</span>
    titletext &lt;-<span class="st"> </span><span class="kw">expression</span>(<span class="kw">atop</span>(<span class="st">&quot;Simulated Drug Concentrations&quot;</span>,
                                 <span class="kw">atop</span>(<span class="kw">italic</span>(<span class="st">&quot;Two compartment- two tranist first-order absorption&quot;</span>),<span class="st">&quot;Median and 90% Prediction Interval, 1000 subjects&quot;</span>))) 
    
    plotobj &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data=</span>simdf)
    plotobj &lt;-<span class="st"> </span>plotobj +<span class="st"> </span><span class="kw">stat_summary</span>(<span class="kw">aes</span>(<span class="dt">x=</span>TIME, <span class="dt">y=</span> DV),<span class="dt">fun.y=</span>median, <span class="dt">geom=</span><span class="st">&quot;line&quot;</span>, <span class="dt">colour=</span><span class="st">&quot;red&quot;</span>, <span class="dt">size=</span><span class="dv">1</span>)
    plotobj &lt;-<span class="st"> </span>plotobj +<span class="st"> </span><span class="kw">stat_summary</span>(<span class="kw">aes</span>(<span class="dt">x=</span>TIME, <span class="dt">y=</span> DV),<span class="dt">geom=</span><span class="st">&quot;ribbon&quot;</span>, <span class="dt">fun.ymin=</span><span class="st">&quot;CI90lo&quot;</span>, <span class="dt">fun.ymax=</span><span class="st">&quot;CI90hi&quot;</span>, <span class="dt">alpha=</span><span class="fl">0.3</span>)
    plotobj &lt;-<span class="st"> </span>plotobj +<span class="st"> </span><span class="kw">ggtitle</span>(titletext)
    plotobj &lt;-<span class="st"> </span>plotobj +<span class="st"> </span><span class="kw">scale_y_continuous</span>(<span class="st">&quot;DV</span><span class="ch">\n</span><span class="st">&quot;</span>)
    plotobj &lt;-<span class="st"> </span>plotobj +<span class="st"> </span><span class="kw">scale_x_continuous</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">Time after dose&quot;</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">  plotobj</code></pre></div>
<p><img src="data:image/png;base64,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" alt /></p>
</div>
</div>
<div id="applications" class="section level2">
<h2>Applications</h2>
<ul>
<li><p>The PKADVAN package can be used for performing simulations from stochastic population pharmacokinetic models coded in R and incorporated into reactive ‘Shiny’ web applications where speed is important as it allows for simulating larger populations without compromising the reactivity of the Shiny application.</p></li>
<li><p>The PKADVAN package can be implemented for data fitting, and for calculating confidence and prediction intervals of pharmacokinetic models’ parameters <a href="#fn4" class="footnoteRef" id="fnref4"><sup>4</sup></a>.</p></li>
<li><p>The PKADVAN package could be incorporated into an open-source mixed-effect modelling framework to estimate population parameters where speed is always desirable.</p></li>
</ul>
</div>
<div id="conclusions" class="section level2">
<h2>Conclusions</h2>
<p>With its speed advantages and the capacity to handle arbitrary dosing regimens and covariate structures, the “PKADVAN” package is expected to facilitate the investigation of a useful open-source software for modelling and simulating pharmacokinetic data.</p>
</div>
<div id="to-do-list" class="section level2">
<h2>To do list</h2>
<ul>
<li>Implement steady-state functionality, as achieved with the SS and II data items in NONMEM.</li>
<li>Implement analytical solutions for combined dosing regimens (e.g., IV bolus plus infusion).</li>
<li>Implement the analytical solutions for fitting population PK data</li>
</ul>
</div>
<div class="footnotes">
<hr />
<ol>
<li id="fn1"><p>Abuhelwa AY, Foster DJ, Upton RN. 2015. ADVAN-style analytical solutions for common pharmacokinetic models. J Pharmacol Toxicol Methods 73:42-48.<a href="#fnref1">↩</a></p></li>
<li id="fn2"><p>R Core Team. 2014. R: A Language and Environment for Statistical Computing R Foundation for Statistical Computing, Vienna, Austria.<a href="#fnref2">↩</a></p></li>
<li id="fn3"><p>Eddelbuettel D, François R, Allaire J, Chambers J, Bates D, Ushey K. 2011. Rcpp: Seamless R and C++ integration. Journal of Statistical Software 40:1-18.<a href="#fnref3">↩</a></p></li>
<li id="fn4"><p>Kümmel A, Abuhelwa AY, Dingemanse J, Krause A. PECAN, a Shiny application for calculating confidence and prediction intervals for pharmacokinetic and pharmacodynamic models. The twenty-fifth Annual Population Approach Group Europe (PAGE) Meeting. 2016<a href="#fnref4">↩</a></p></li>
</ol>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
